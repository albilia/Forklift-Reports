<!-- ⭐ תפריט צד — Nis רפורטר ⭐ -->

<style>
  .menu-button {
    position: fixed;
    top: 15px;
    right: 15px;
    width: 35px;
    height: 30px;
    cursor: pointer;
    z-index: 1100;
    display: flex;
    flex-direction: column;
    justify-content: space-between;
  }

  .menu-button span {
    display: block;
    height: 4px;
    background: #333;
    border-radius: 4px;
    transition: 0.35s;
  }

  .menu-button.active span:nth-child(1) {
    transform: rotate(45deg) translate(6px, 6px);
  }

  .menu-button.active span:nth-child(2) {
    opacity: 0;
  }

  .menu-button.active span:nth-child(3) {
    transform: rotate(-45deg) translate(7px, -7px);
  }

  .side-menu {
    position: fixed;
    top: 0;
    right: -260px;
    width: 260px;
    height: 100%;
    background: white;
    box-shadow: -3px 0 8px rgba(0,0,0,0.25);
    transition: 0.35s ease;
    padding-top: 70px;
    z-index: 1050;
    overflow-y: auto;
  }

  .side-menu.open {
    right: 0;
  }

  .menu-item {
    padding: 15px;
    border-bottom: 1px solid #ddd;
    font-size: 18px;
    cursor: pointer;
    text-align: right;
    color: #000;
  }

  .menu-item:hover {
    background: #f0f0f0;
  }
</style>

<!-- כפתור המבורגר -->
<div class="menu-button" id="menuBtn">
  <span></span>
  <span></span>
  <span></span>
</div>

<!-- תפריט צד -->
<div id="sideMenu" class="side-menu">

  <div class="menu-item" onclick="openAbout()">אודות</div>
  <div class="menu-item" onclick="openSteps()">שלבים</div>

  <div class="menu-item" onclick="openGithub()">
    <img src="github-icon.png"
         alt="icon"
         style="width:24px; height:24px; vertical-align:middle; margin-left:8px;">
    פתיחת טיקט
  </div>

  <div id="versionLine" class="menu-item" style="font-size:14px; color:#555; margin-top:10px;">
    מס' גרסה: ...
  </div>

  <!-- ⭐ זכויות יוצרים ⭐ -->
  <div style="text-align:center; margin-top:15px; font-size:16px; font-weight:bold;">
    © פותח על ידי ניסים אלביליה
  </div>

  <!-- ⭐ תמונה ⭐ -->
  <div style="text-align:center; margin-top:10px;">
    <img 
      src="https://raw.githubusercontent.com/albilia/Forklift-Reports/main/me.jpg"
      alt="תמונה"
      style="
        width:80px;
        height:80px;
        border-radius:50%;
        object-fit:cover;
      "
    >
  </div>

</div>

<!-- ⭐ מודאל מבודד ⭐ -->
<div id="infoModal" style="
  display:none !important;
  position:fixed !important;
  top:0 !important;
  left:0 !important;
  width:100% !important;
  height:100% !important;
  background:rgba(0,0,0,0.6) !important;
  z-index:999999 !important;
  padding:20px !important;
  box-sizing:border-box !important;
">
  <div style="
    background:white !important;
    color:black !important;
    max-width:500px !important;
    margin:60px auto !important;
    padding:20px !important;
    border-radius:10px !important;
    box-shadow:0 0 10px rgba(0,0,0,0.3) !important;
    max-height:80% !important;
    overflow-y:auto !important;
    text-align:right !important;
    direction:rtl !important;
    font-size:18px !important;
    line-height:1.6 !important;
  ">
    <div style="text-align:left !important;">
      <span onclick="closeModal()" style="cursor:pointer !important; font-size:26px !important;">✕</span>
    </div>
    <h2 id="modalTitle" style="margin-top:0 !important; font-size:24px !important; font-weight:bold !important;"></h2>
    <div id="modalBody" style="white-space:pre-line !important;"></div>
  </div>
</div>

<script>
  /* פתיחה/סגירה של התפריט */
  const menuBtn = document.getElementById("menuBtn");
  const sideMenu = document.getElementById("sideMenu");

  menuBtn.addEventListener("click", () => {
    menuBtn.classList.toggle("active");
    sideMenu.classList.toggle("open");
    navigator.vibrate?.(20);
  });

  /* טעינת גרסה */
  async function loadVersion() {
    try {
      const res = await fetch(
        "https://raw.githubusercontent.com/albilia/Forklift-Reports/main/version.json?t=" + Date.now()
      );
      const data = await res.json();
      document.getElementById("versionLine").textContent = "מס' גרסה: " + data.version;
    } catch (e) {
      console.log("Version fetch failed");
    }
  }
  loadVersion();

  /* ⭐ מודאל ⭐ */
  function openModal(title, body) {
    document.getElementById("modalTitle").innerText = title;
    document.getElementById("modalBody").innerText = body;
    document.getElementById("infoModal").style.display = "block";
  }

  function closeModal() {
    document.getElementById("infoModal").style.display = "none";
  }

  /* ⭐ אודות ⭐ */
  function openAbout() {
    openModal(
      "אודות המערכת",
      "מערכת Nis רפורטר פותחה לתת מענה לסריקת תוויות ומדבקות במחסנים.\n" +
      "לכל מחסן נכתב קוד מותאם למערכת Google Cloud Vision OCR.\n\n" +
      "מחסן חומרי גלם משתמש בקוד לקריאת מדבקות.\n" +
      "מחסן תוצר גמר משתמש בקוד לקריאת תוויות.\n\n" +
      "הכניסה למערכת מתבצעת באמצעות זיהוי מספר הנייד של העובד שהורשה לכך.\n" +
      "מנהל העבודה יכול להוסיף או למחוק משתמשים במערכת ניהול המשתמשים.\n\n" +
      "© כל הזכויות שמורות — Nis רפורטר"
    );
  }

  /* ⭐ שלבים ⭐ */
  function openSteps() {
    openModal(
      "שלבי העבודה",
      "1. הזן מספר טלפון במסך הכניסה.\n" +
      "2. בחר מחסן — חומרי גלם / תוצר גמר.\n" +
      "3. במחסן תוצר גמר: בחר תת מחסן.\n" +
      "4. במסך הדיווח: לחץ על אייקון המצלמה לצילום.\n" +
      "5. לחץ 'פענח הכל' לשליחת התמונות ל־OCR.\n" +
      "6. אם הפענוח תקין — לחץ 'שמור דיווח'."
    );
  }

  /* ⭐ פתיחת טיקט ⭐ */
  function openGithub() {
    window.open("https://github.com/albilia/Forklift-Reports/issues", "_blank");
  }
</script>
